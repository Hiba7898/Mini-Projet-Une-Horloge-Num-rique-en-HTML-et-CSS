<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horloge Numérique Complète</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            transition: background 0.5s ease;
            overflow-x: hidden;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 90%;
            max-width: 600px;
            margin: 40px 0;
        }
        
        .clock-container, .stopwatch-container, .alarm-container, .timer-container {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            text-align: center;
            animation: slideIn 0.5s;
        }
        
        .tab-container {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .tab {
            padding: 12px 20px;
            background-color: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            flex-grow: 1;
            user-select: none;
        }
        
        .tab:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .tab.active {
            background-color: rgba(255, 255, 255, 0.4);
            font-weight: bold;
        }
        
        /* HORLOGE STYLES */
        .clock {
            font-size: 5rem;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            margin: 10px 0;
            font-variant-numeric: tabular-nums;
        }
        
        .date {
            font-size: 1.5rem;
            opacity: 0.8;
            margin-bottom: 20px;
        }
        
        /* STYLES HORLOGE ANALOGIQUE */
        .analog-digital-switch {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
            gap: 5px;
        }
        
        .analog-digital-switch button {
            padding: 8px 15px;
            min-width: 90px;
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .analog-digital-switch button.active {
            background-color: rgba(255, 255, 255, 0.4);
            font-weight: bold;
        }
        
        .analog-clock {
            width: 250px;
            height: 250px;
            margin: 20px auto;
            position: relative;
        }
        
        .clock-face {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1);
            position: relative;
            border: 5px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
        }
        
        .marking {
            position: absolute;
            width: 4px;
            height: 100%;
            background: transparent;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .marking::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            top: 10px;
            left: 0;
        }
        
        .marking::before {
            content: '';
            position: absolute;
            width: 4px;
            height: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            bottom: 10px;
            left: 0;
        }
        
        .marking-one {
            transform: translateX(-50%) rotate(30deg);
        }
        
        .marking-two {
            transform: translateX(-50%) rotate(60deg);
        }
        
        .marking-three {
            transform: translateX(-50%) rotate(90deg);
        }
        
        .marking-four {
            transform: translateX(-50%) rotate(120deg);
        }
        
        .marking-five {
            transform: translateX(-50%) rotate(150deg);
        }
        
        .marking-six {
            transform: translateX(-50%) rotate(180deg);
        }
        
        .hour-hand, .minute-hand, .second-hand {
            position: absolute;
            background-color: white;
            border-radius: 5px;
            transform-origin: bottom center;
            bottom: 50%;
            left: 50%;
            z-index: 10;
        }
        
        .hour-hand {
            width: 8px;
            height: 60px;
            background-color: white;
            transform: translateX(-50%);
        }
        
        .minute-hand {
            width: 6px;
            height: 90px;
            background-color: white;
            transform: translateX(-50%);
        }
        
        .second-hand {
            width: 2px;
            height: 110px;
            background-color: #ff6b6b;
            transform: translateX(-50%);
        }
        
        .center-point {
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #ff6b6b;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 11;
        }
        
        /* THÈMES ET SÉLECTEUR */
        .theme-selector {
            position: relative;
            display: inline-block;
        }
        
        .theme-dropdown {
            display: none;
            position: absolute;
            background-color: rgba(0, 0, 0, 0.7);
            min-width: 150px;
            border-radius: 5px;
            padding: 10px;
            z-index: 100;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            right: 0;
        }
        
        .theme-selector:hover .theme-dropdown {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            animation: fadeIn 0.3s;
        }
        
        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .theme-option:hover {
            transform: scale(1.2);
            border-color: white;
        }
        
        /* CHRONOMÈTRE STYLES */
        .stopwatch-display {
            font-size: 3.5rem;
            font-variant-numeric: tabular-nums;
            margin: 20px 0;
        }
        
        .laps {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 10px;
            text-align: left;
        }
        
        .lap-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .lap-item:last-child {
            border-bottom: none;
        }
        
        /* STYLES DE L'ALARME */
        .alarm-inputs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .alarm-inputs input {
            width: 70px;
            padding: 10px;
            font-size: 1.2rem;
            text-align: center;
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 5px;
            color: white;
        }
        
        .alarm-inputs input:focus {
            outline: 2px solid rgba(255, 255, 255, 0.5);
        }
        
        .alarm-inputs span {
            font-size: 1.5rem;
            align-self: center;
        }
        
        .alarm-list {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 10px;
            text-align: left;
        }
        
        .alarm-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .alarm-time {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .alarm-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .delete-alarm {
            background-color: rgba(231, 76, 60, 0.8);
            padding: 5px 10px;
            min-width: auto;
            border-radius: 3px;
        }
        
        .alarm-toggle {
            width: 40px;
            height: 22px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            cursor: pointer;
            position: relative;
            transition: background-color 0.3s;
        }
        
        .alarm-toggle::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            background-color: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }
        
        .alarm-toggle.active {
            background-color: #2ecc71;
        }
        
        .alarm-toggle.active::after {
            left: 20px;
        }
        
        /* Alerte d'alarme */
        .alarm-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: none;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s;
        }
        
        .alarm-alert-content {
            background-color: #e74c3c;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            animation: scaleIn 0.5s;
            max-width: 90%;
        }
        
        /* STYLES DU MINUTEUR */
        .preset-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .preset-btn {
            padding: 8px 15px;
            background-color: rgba(255, 255, 255, 0.2);
            min-width: 70px;
        }
        
        .preset-btn.active {
            background-color: rgba(255, 255, 255, 0.4);
            font-weight: bold;
        }
        
        .timer-display {
            margin: 30px auto;
            width: 250px;
            height: 250px;
            position: relative;
        }
        
        .timer-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .timer-progress {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(transparent 0%, transparent 100%);
            transition: background 0.3s;
        }
        
        .timer-time {
            font-size: 3.5rem;
            color: white;
            z-index: 10;
            font-variant-numeric: tabular-nums;
        }
        
        .sound-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .sound-btn {
            padding: 8px 15px;
            background-color: rgba(255, 255, 255, 0.2);
            min-width: 80px;
        }
        
        .sound-btn.active {
            background-color: rgba(255, 255, 255, 0.4);
            font-weight: bold;
        }
        
        /* BOUTONS ET CONTRÔLES */
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        button {
            background-color: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            font-weight: 500;
        }
        
        button:hover {
            background-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ANIMATION DE FOND */
        .dynamic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-bubble {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 15s infinite;
            opacity: 0.5;
        }

        /* KEYFRAMES ET ANIMATIONS */
        @keyframes pulse {
            0% { text-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
            50% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.7); }
            100% { text-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
        }
        
        .running {
            animation: pulse 2s infinite;
            color: #2ecc71;
        }
        
        @keyframes ring {
            0% { transform: rotate(-5deg); }
            25% { transform: rotate(5deg); }
            50% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
            100% { transform: rotate(-5deg); }
        }
        
        .ringing {
            animation: ring 0.2s infinite;
            color: #e74c3c;
            background-color: rgba(231, 76, 60, 0.2);
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.5;
            }
            50% {
                transform: translateY(-100px) rotate(180deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(0) rotate(360deg);
                opacity: 0.5;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); }
            to { transform: scale(1); }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse-end {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .timer-end {
            animation: pulse-end 0.5s infinite;
        }
        
        /* MEDIA QUERIES POUR RESPONSIVE */
        @media (max-width: 600px) {
            .tab {
                padding: 10px 5px;
                font-size: 0.9rem;
            }
            
            .clock {
                font-size: 3.5rem;
            }
            
            .stopwatch-display, .timer-time {
                font-size: 2.5rem;
            }
            
            .analog-clock, .timer-display {
                width: 200px;
                height: 200px;
            }
            
            .controls {
                gap: 5px;
            }
            
            button {
                min-width: 100px;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('clock')">Horloge</div>
            <div class="tab" onclick="switchTab('stopwatch')">Chronomètre</div>
            <div class="tab" onclick="switchTab('alarm')">Alarme</div>
            <div class="tab" onclick="switchTab('timer')">Minuteur</div>
        </div>
        
        <!-- HORLOGE -->
        <div class="clock-container" id="clock-tab">
            <div class="analog-digital-switch">
                <button id="digital-btn" class="active">Digital</button>
                <button id="analog-btn">Analogique</button>
            </div>
            
            <div id="digital-clock">
                <div class="date" id="date">Mardi 13 Février 2024</div>
                <div class="clock" id="clock">00:00:00</div>
            </div>
            
            <div class="analog-clock" id="analog-clock" style="display: none;">
                <div class="clock-face">
                    <div class="marking marking-one"></div>
                    <div class="marking marking-two"></div>
                    <div class="marking marking-three"></div>
                    <div class="marking marking-four"></div>
                    <div class="marking marking-five"></div>
                    <div class="marking marking-six"></div>
                    <div class="hour-hand"></div>
                    <div class="minute-hand"></div>
                    <div class="second-hand"></div>
                    <div class="center-point"></div>
                </div>
            </div>
            
            <div class="controls">
                <div class="theme-selector">
                    <button id="theme-toggle" class="theme-btn">Thèmes</button>
                    <div class="theme-dropdown">
                        <div class="theme-option" data-theme="blue" style="background: linear-gradient(45deg, #2c3e50, #3498db);"></div>
                        <div class="theme-option" data-theme="sunset" style="background: linear-gradient(45deg, #f39c12, #e74c3c);"></div>
                        <div class="theme-option" data-theme="forest" style="background: linear-gradient(45deg, #27ae60, #2ecc71);"></div>
                        <div class="theme-option" data-theme="night" style="background: linear-gradient(45deg, #2c3e50, #8e44ad);"></div>
                        <div class="theme-option" data-theme="ocean" style="background: linear-gradient(45deg, #1abc9c, #3498db);"></div>
                    </div>
                </div>
                <button id="format-toggle">Format 24h / 12h</button>
            </div>
        </div>
        
        <!-- CHRONOMÈTRE -->
        <div class="stopwatch-container" id="stopwatch-tab" style="display: none;">
            <h2>Chronomètre</h2>
            <div class="stopwatch-display" id="stopwatch">00:00:00.00</div>
            <div class="controls">
                <button id="start-btn">Démarrer</button>
                <button id="lap-btn" disabled>Tour</button>
                <button id="reset-btn" disabled>Réinitialiser</button>
            </div>
            <div class="laps" id="laps"></div>
        </div>
        
        <!-- ALARME -->
        <div class="alarm-container" id="alarm-tab" style="display: none;">
            <h2>Alarme</h2>
            <div class="alarm-inputs">
                <input type="number" id="alarm-hours" min="0" max="23" value="12" placeholder="HH">
                <span>:</span>
                <input type="number" id="alarm-minutes" min="0" max="59" value="00" placeholder="MM">
                <span>:</span>
                <input type="number" id="alarm-seconds" min="0" max="59" value="00" placeholder="SS">
            </div>
            <div class="controls">
                <button id="set-alarm-btn">Définir Alarme</button>
                <button id="clear-all-alarms-btn">Effacer Tout</button>
            </div>
            <div class="alarm-list" id="alarm-list">
                <div class="alarm-item">
                    <div class="alarm-time">Pas d'alarmes programmées</div>
                </div>
            </div>
        </div>
        
        <!-- MINUTEUR -->
        <div class="timer-container" id="timer-tab" style="display: none;">
            <h2>Minuteur</h2>
            
            <div class="preset-buttons">
                <button class="preset-btn" data-minutes="5">5 min</button>
                <button class="preset-btn" data-minutes="10">10 min</button>
                <button class="preset-btn data-minutes="15">15 min</button>
                <button class="preset-btn" data-minutes="25">25 min</button>
                <button class="preset-btn" data-minutes="30">30 min</button>
            </div>
            
            <div class="timer-display">
                <div class="timer-circle" id="timer-circle">
                    <div class="timer-progress" id="timer-progress"></div>
                    <div class="timer-time" id="timer-time">25:00</div>
                </div>
            </div>
            
            <div class="controls">
                <button id="timer-start-btn">Démarrer</button>
                <button id="timer-pause-btn" disabled>Pause</button>
                <button id="timer-reset-btn" disabled>Réinitialiser</button>
            </div>
            
            <div class="ambient-sound">
                <h3>Ambiance Sonore</h3>
                <div class="sound-options">
                    <button class="sound-btn" data-sound="rain">Pluie</button>
                    <button class="sound-btn" data-sound="forest">Forêt</button>
                    <button class="sound-btn" data-sound="waves">Vagues</button>
                    <button class="sound-btn" data-sound="none">Silence</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Alerte d'alarme -->
    <div class="alarm-alert" id="alarm-alert">
        <div class="alarm-alert-content">
            <h2>⏰ Alarme! ⏰</h2>
            <p>Il est temps!</p>
            <button id="stop-alarm-btn">Arrêter</button>
        </div>
    </div>

    <script>
        // ========== VARIABLES GLOBALES ==========
        
        // Variables de l'horloge
        let is24HourFormat = true;
        let isDarkTheme = true;
        
        // Variables du chronomètre
        let stopwatchInterval;
        let startTime;
        let elapsedTime = 0;
        let isRunning = false;
        let lapCount = 0;
        
        // Variables d'alarme
        let alarms = [];
        let alarmSound;
        let alarmCheckInterval;
        
        // Variables du minuteur
        let timerInterval;
        let timerDuration = 25 * 60; // 25 minutes par défaut (en secondes)
        let timerRemaining = timerDuration;
        let timerRunning = false;
        let ambientSound = null;
        let audioContext = null;
        
        // ========== FONCTIONS DE L'HORLOGE ==========
        
        // Fonction pour mettre à jour l'horloge numérique
        function updateClock() {
            const now = new Date();
            
            // Mettre à jour l'heure
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            // Format 12h / 24h
            let displayHours;
            if (!is24HourFormat) {
                displayHours = (hours % 12) || 12;
                displayHours = displayHours.toString().padStart(2, '0');
                document.getElementById('clock').textContent = 
                    `${displayHours}:${minutes}:${seconds} ${hours >= 12 ? 'PM' : 'AM'}`;
            } else {
                displayHours = hours.toString().padStart(2, '0');
                document.getElementById('clock').textContent = 
                    `${displayHours}:${minutes}:${seconds}`;
            }
            
            // Mettre à jour la date
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateString = now.toLocaleDateString('fr-FR', options);
            document.getElementById('date').textContent = dateString.charAt(0).toUpperCase() + dateString.slice(1);
            
            // Vérifier les alarmes
            checkAlarms(hours, minutes, seconds);
        }
        
        // Fonction pour mettre à jour l'horloge analogique
        function updateAnalogClock() {
            const now = new Date();
            
            const seconds = now.getSeconds();
            const minutes = now.getMinutes();
            const hours = now.getHours();
            
            // Calculer les degrés de rotation pour chaque aiguille
            const secondsDegrees = ((seconds / 60) * 360) + 180;
            const minutesDegrees = ((minutes / 60) * 360) + ((seconds / 60) * 6) + 180;
            const hoursDegrees = ((hours / 12) * 360) + ((minutes / 60) * 30) + 180;
            
            // Appliquer les rotations
            document.querySelector('.second-hand').style.transform = `translateX(-50%) rotate(${secondsDegrees}deg)`;
            document.querySelector('.minute-hand').style.transform = `translateX(-50%) rotate(${minutesDegrees}deg)`;
            document.querySelector('.hour-hand').style.transform = `translateX(-50%) rotate(${hoursDegrees}deg)`;
        }
        
        // Fonction pour basculer entre horloge numérique et analogique
        function toggleClockMode(mode) {
            if (mode === 'digital') {
                document.getElementById('digital-clock').style.display = 'block';
                document.getElementById('analog-clock').style.display = 'none';
                document.getElementById('digital-btn').classList.add('active');
                document.getElementById('analog-btn').classList.remove('active');
            } else {
                document.getElementById('digital-clock').style.display = 'none';
                document.getElementById('analog-clock').style.display = 'block';
                document.getElementById('digital-btn').classList.remove('active');
                document.getElementById('analog-btn').classList.add('active');
                // Mettre à jour l'horloge analogique immédiatement
                updateAnalogClock();
            }
        }
        
        // Fonction pour changer le thème
        function changeTheme(theme) {
            switch(theme) {
                case 'blue':
                    document.body.style.background = 'linear-gradient(45deg, #2c3e50, #3498db)';
                    break;
                case 'sunset':
                    document.body.style.background = 'linear-gradient(45deg, #f39c12, #e74c3c)';
                    break;
                case 'forest':
                    document.body.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
                    break;
                case 'night':
                    document.body.style.background = 'linear-gradient(45deg, #2c3e50, #8e44ad)';
                    break;
                case 'ocean':
                    document.body.style.background = 'linear-gradient(45deg, #1abc9c, #3498db)';
                    break;
                default:
                    document.body.style.background = 'linear-gradient(45deg, #2c3e50, #3498db)';
            }
        }
        
        // ========== FONCTIONS DU CHRONOMÈTRE ==========
        
        // Fonction pour formater le temps du chronomètre
        function formatStopwatchTime(ms) {
            const totalCentiseconds = Math.floor(ms / 10);
            const centiseconds = totalCentiseconds % 100;
            const totalSeconds = Math.floor(totalCentiseconds / 100);
            const seconds = totalSeconds % 60;
            const totalMinutes = Math.floor(totalSeconds / 60);
            const minutes = totalMinutes % 60;
            const hours = Math.floor(totalMinutes / 60);
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${centiseconds.toString().padStart(2, '0')}`;
        }
        
        // Fonction pour mettre à jour l'affichage du chronomètre
        function updateStopwatch() {
            const currentTime = Date.now();
            const timeElapsed = currentTime - startTime + elapsedTime;
            document.getElementById('stopwatch').textContent = formatStopwatchTime(timeElapsed);
        }
        
        // Fonction pour démarrer le chronomètre
        function startStopwatch() {
            if (!isRunning) {
                startTime = Date.now();
                stopwatchInterval = setInterval(updateStopwatch, 10);
                isRunning = true;
                
                // Mettre à jour les boutons
                document.getElementById('start-btn').textContent = 'Arrêter';
                document.getElementById('lap-btn').disabled = false;
                document.getElementById('reset-btn').disabled = true;
                
                // Ajouter la classe d'animation
                document.getElementById('stopwatch').classList.add('running');
            } else {
                clearInterval(stopwatchInterval);
                elapsedTime += Date.now() - startTime;
                isRunning = false;
                
                // Mettre à jour les boutons
                document.getElementById('start-btn').textContent = 'Reprendre';
                document.getElementById('lap-btn').disabled = true;
                document.getElementById('reset-btn').disabled = false;
                
                // Supprimer la classe d'animation
                document.getElementById('stopwatch').classList.remove('running');
            }
        }
        
        // Fonction pour enregistrer un tour
        function recordLap() {
            if (isRunning) {
                lapCount++;
                const currentTime = Date.now() - startTime + elapsedTime;
                const lapTime = formatStopwatchTime(currentTime);
                
                const lapElement = document.createElement('div');
                lapElement.className = 'lap-item';
                lapElement.innerHTML = `
                    <span>Tour ${lapCount}</span>
                    <span>${lapTime}</span>
                `;
                
                // Ajouter au début de la liste
                const lapsContainer = document.getElementById('laps');
                lapsContainer.insertBefore(lapElement, lapsContainer.firstChild);
            }
        }
        
        // Fonction pour réinitialiser le chronomètre
        function resetStopwatch() {
            clearInterval(stopwatchInterval);
            document.getElementById('stopwatch').textContent = '00:00:00.00';
            document.getElementById('start-btn').textContent = 'Démarrer';
            document.getElementById('lap-btn').disabled = true;
            document.getElementById('reset-btn').disabled = true;
            document.getElementById('laps').innerHTML = '';
            
            elapsedTime = 0;
            isRunning = false;
            lapCount = 0;
        }
        
        // ========== FONCTIONS DE L'ALARME ==========
        
        // Fonction pour ajouter une alarme
        function addAlarm() {
            const hours = parseInt(document.getElementById('alarm-hours').value) || 0;
            const minutes = parseInt(document.getElementById('alarm-minutes').value) || 0;
            const seconds = parseInt(document.getElementById('alarm-seconds').value) || 0;
            
            // Vérifier si les valeurs sont valides
            if (hours > 23 || minutes > 59 || seconds > 59) {
                alert("Veuillez entrer des valeurs d'heure valides!");
                return;
            }
            
            // Créer un ID unique pour l'alarme
            const alarmId = Date.now();
            
            // Créer un nouvel objet alarme
            const newAlarm = {
                id: alarmId,
                hours: hours,
                minutes: minutes,
                seconds: seconds,
                active: true
            };
            
            // Ajouter l'alarme à la liste
            alarms.push(newAlarm);
            
            // Mettre à jour l'affichage
            updateAlarmList();
            
            // Réinitialiser les champs
            document.getElementById('alarm-hours').value = '12';
            document.getElementById('alarm-minutes').value = '00';
            document.getElementById('alarm-seconds').value = '00';
        }
        
        // Fonction pour mettre à jour la liste des alarmes
        function updateAlarmList() {
            const alarmList = document.getElementById('alarm-list');
            
            // Vider la liste
            alarmList.innerHTML = '';
            
            // Si aucune alarme, afficher un message
            if (alarms.length === 0) {
                alarmList.innerHTML = `
                    <div class="alarm-item">
                        <div class="alarm-time">Pas d'alarmes programmées</div>
                    </div>
                `;
                return;
            }
            
            // Ajouter chaque alarme à la liste
            alarms.forEach(alarm => {
                const alarmItem = document.createElement('div');
                alarmItem.className = 'alarm-item';
                
                const formattedHours = alarm.hours.toString().padStart(2, '0');
                const formattedMinutes = alarm.minutes.toString().padStart(2, '0');
                const formattedSeconds = alarm.seconds.toString().padStart(2, '0');
                
                alarmItem.innerHTML = `
                    <div class="alarm-time">${formattedHours}:${formattedMinutes}:${formattedSeconds}</div>
                    <div class="alarm-status">
                        <div class="alarm-toggle ${alarm.active ? 'active' : ''}" onclick="toggleAlarm(${alarm.id})"></div>
                        <button class="delete-alarm" onclick="deleteAlarm(${alarm.id})">×</button>
                    </div>
                `;
                
                alarmList.appendChild(alarmItem);
            });
        }
        
        // Fonction pour activer/désactiver une alarme
        function toggleAlarm(id) {
            const alarmIndex = alarms.findIndex(alarm => alarm.id === id);
            if (alarmIndex !== -1) {
                alarms[alarmIndex].active = !alarms[alarmIndex].active;
                updateAlarmList();
            }
        }
        
        // Fonction pour supprimer une alarme
        function deleteAlarm(id) {
            alarms = alarms.filter(alarm => alarm.id !== id);
            updateAlarmList();
        }
        
        // Fonction pour supprimer toutes les alarmes
        function clearAllAlarms() {
            alarms = [];
            updateAlarmList();
        }
        
        // Fonction pour vérifier si une alarme doit sonner
        function checkAlarms(hours, minutes, seconds) {
            alarms.forEach(alarm => {
                if (alarm.active && 
                    alarm.hours === hours && 
                    alarm.minutes === minutes && 
                    alarm.seconds === seconds) {
                    triggerAlarm(alarm);
                }
            });
        }
        
        // Fonction pour déclencher l'alarme
        function triggerAlarm(alarm) {
            // Afficher l'alerte
            document.getElementById('alarm-alert').style.display = 'flex';
            
            // Faire jouer le son
            playAlarmSound();
            
            // Faire vibrer (si disponible)
            if ('vibrate' in navigator) {
                navigator.vibrate([300, 100, 300, 100, 300]);
            }
        }
        
        // Fonction pour arrêter l'alarme
        function stopAlarm() {
            document.getElementById('alarm-alert').style.display = 'none';
            stopAlarmSound();
        }
        
        // Fonction pour jouer le son d'alarme
        function playAlarmSound() {
            try {
                // Créer un contexte audio
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const audioContext = new AudioContext();
                
                // Utiliser un oscillateur pour générer un son de type "bip"
                alarmSound = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                alarmSound.type = 'square';
                alarmSound.frequency.value = 800;
                gainNode.gain.value = 0.2;
                
                alarmSound.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Démarrer le son avec un motif d'alarme
                alarmSound.start();
                
                // Créer un motif de son (bip-bip-bip)
                let isOn = true;
                alarmCheckInterval = setInterval(() => {
                    isOn = !isOn;
                    gainNode.gain.value = isOn ? 0.2 : 0;
                }, 300);
            } catch (error) {
                console.error("Erreur lors de la lecture du son d'alarme:", error);
            }
        }
        
        // Fonction pour arrêter le son d'alarme
        function stopAlarmSound() {
            if (alarmSound) {
                try {
                    alarmSound.stop();
                    clearInterval(alarmCheckInterval);
                } catch (error) {
                    console.error("Erreur lors de l'arrêt du son d'alarme:", error);
                }
            }
        }
        
        // ========== FONCTIONS DU MINUTEUR ==========
        
        // Fonction pour formater le temps (mm:ss)
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // Fonction pour mettre à jour l'affichage du minuteur
        function updateTimerDisplay() {
            document.getElementById('timer-time').textContent = formatTime(timerRemaining);
            
            // Mettre à jour la progression visuelle
            const progress = (timerDuration - timerRemaining) / timerDuration * 100;
            document.getElementById('timer-progress').style.background = 
                `conic-gradient(rgba(46, 204, 113, 0.8) 0%, rgba(46, 204, 113, 0.8) ${progress}%, transparent ${progress}%, transparent 100%)`;
            
            // Si le minuteur est terminé
            if (timerRemaining <= 0) {
                clearInterval(timerInterval);
                timerRunning = false;
                document.getElementById('timer-circle').classList.add('timer-end');
                document.getElementById('timer-start-btn').disabled = true;
                document.getElementById('timer-pause-btn').disabled = true;
                document.getElementById('timer-reset-btn').disabled = false;
                
                // Jouer le son de fin
                playEndSound();
            }
        }
        
        // Fonction pour démarrer le minuteur
        function startTimer() {
            if (timerRunning) return;
            
            timerRunning = true;
            
            // Mettre à jour les boutons
            document.getElementById('timer-start-btn').disabled = true;
            document.getElementById('timer-pause-btn').disabled = false;
            document.getElementById('timer-reset-btn').disabled = false;
            
            // Démarrer le minuteur
            timerInterval = setInterval(() => {
                timerRemaining--;
                updateTimerDisplay();
                
                if (timerRemaining <= 0) {
                    clearInterval(timerInterval);
                }
            }, 1000);
        }
        
        // Fonction pour mettre en pause le minuteur
        function pauseTimer() {
            if (!timerRunning) return;
            
            timerRunning = false;
            clearInterval(timerInterval);
            
            // Mettre à jour les boutons
            document.getElementById('timer-start-btn').disabled = false;
            document.getElementById('timer-pause-btn').disabled = true;
            document.getElementById('timer-reset-btn').disabled = false;
        }
        
        // Fonction pour réinitialiser le minuteur
        function resetTimer() {
            clearInterval(timerInterval);
            timerRunning = false;
            timerRemaining = timerDuration;
            updateTimerDisplay();
            
            // Réinitialiser l'animation
            document.getElementById('timer-circle').classList.remove('timer-end');
            
            // Mettre à jour les boutons
            document.getElementById('timer-start-btn').disabled = false;
            document.getElementById('timer-pause-btn').disabled = true;
            document.getElementById('timer-reset-btn').disabled = true;
        }
        
        // Fonction pour définir la durée du minuteur
        function setTimerDuration(minutes) {
            pauseTimer();
            timerDuration = minutes * 60;
            timerRemaining = timerDuration;
            updateTimerDisplay();
            resetTimer();
            
            // Mettre à jour les boutons préréglés
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.preset-btn[data-minutes="${minutes}"]`).classList.add('active');
        }
        
        // Fonction pour jouer un son d'ambiance
        function playAmbientSound(sound) {
            // Arrêter le son précédent
            if (ambientSound) {
                try {
                    ambientSound.stop();
                    ambientSound = null;
                } catch (error) {
                    console.error("Erreur lors de l'arrêt du son d'ambiance:", error);
                }
            }
            
            if (sound === 'none') return;
            
            try {
                // Initialiser l'API Audio si nécessaire
                if (!audioContext) {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    audioContext = new AudioContext();
                }
                
                // Créer un oscillateur pour simuler des sons d'ambiance
                ambientSound = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                // Configurer le son selon le type
                switch(sound) {
                    case 'rain':
                        // Simulation de pluie avec un bruit blanc filtré
                        ambientSound.type = 'triangle';
                        ambientSound.frequency.value = 100;
                        gainNode.gain.value = 0.05;
                        break;
                    case 'forest':
                        // Simulation de forêt avec un son plus grave
                        ambientSound.type = 'triangle';
                        ambientSound.frequency.value = 150;
                        gainNode.gain.value = 0.02;
                        break;
                    case 'waves':
                        // Simulation de vagues avec un son plus ondulant
                        ambientSound.type = 'sine';
                        ambientSound.frequency.value = 200;
                        gainNode.gain.value = 0.03;
                        
                        // LFO pour simuler le mouvement des vagues
                        const lfo = audioContext.createOscillator();
                        lfo.frequency.value = 0.2;
                        const lfoGain = audioContext.createGain();
                        lfoGain.gain.value = 50;
                        lfo.connect(lfoGain);
                        lfoGain.connect(ambientSound.frequency);
                        lfo.start();
                        break;
                }
                
                ambientSound.connect(gainNode);
                gainNode.connect(audioContext.destination);
                ambientSound.start();
            } catch (error) {
                console.error("Erreur lors de la lecture du son d'ambiance:", error);
            }
            
            // Mettre à jour les boutons de son
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.sound-btn[data-sound="${sound}"]`).classList.add('active');
        }
        
        // Fonction pour jouer le son de fin
        function playEndSound() {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const context = new AudioContext();
                
                // Créer un son de "ding"
                const oscillator = context.createOscillator();
                const gainNode = context.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.value = 800;
                gainNode.gain.setValueAtTime(0, context.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.5, context.currentTime + 0.1);
                gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 1.5);
                
                oscillator.connect(gainNode);
                gainNode.connect(context.destination);
                
                oscillator.start(context.currentTime);
                oscillator.stop(context.currentTime + 1.5);
            } catch (error) {
                console.error("Erreur lors de la lecture du son de fin:", error);
            }
        }
        
        // ========== FONCTIONS GÉNÉRALES ==========
        
        // Fonction pour basculer entre les onglets
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            document.getElementById('clock-tab').style.display = 'none';
            document.getElementById('stopwatch-tab').style.display = 'none';
            document.getElementById('alarm-tab').style.display = 'none';
            document.getElementById('timer-tab').style.display = 'none';
            
            if (tab === 'clock') {
                document.getElementById('clock-tab').style.display = 'block';
                document.querySelector('.tab:nth-child(1)').classList.add('active');
            } else if (tab === 'stopwatch') {
                document.getElementById('stopwatch-tab').style.display = 'block';
                document.querySelector('.tab:nth-child(2)').classList.add('active');
            } else if (tab === 'alarm') {
                document.getElementById('alarm-tab').style.display = 'block';
                document.querySelector('.tab:nth-child(3)').classList.add('active');
            } else if (tab === 'timer') {
                document.getElementById('timer-tab').style.display = 'block';
                document.querySelector('.tab:nth-child(4)').classList.add('active');
            }
        }
        
        // Fonction pour créer des bulles d'animation en arrière-plan
        function createBubbles() {
            const dynamicBg = document.createElement('div');
            dynamicBg.className = 'dynamic-bg';
            document.body.appendChild(dynamicBg);
            
            for (let i = 0; i < 15; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bg-bubble';
                
                // Taille aléatoire
                const size = Math.random() * 200 + 50;
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                // Position aléatoire
                bubble.style.left = `${Math.random() * 100}%`;
                bubble.style.top = `${Math.random() * 100}%`;
                
                // Durée et délai d'animation aléatoires
                const duration = Math.random() * 20 + 10;
                const delay = Math.random() * 5;
                bubble.style.animationDuration = `${duration}s`;
                bubble.style.animationDelay = `${delay}s`;
                
                dynamicBg.appendChild(bubble);
            }
        }
        
        // ========== INITIALISATION ET EVENT LISTENERS ==========
        
        // Fonction appelée au chargement de la page
        window.addEventListener('load', function() {
            // Mettre à jour l'horloge numérique chaque seconde
            updateClock();
            setInterval(updateClock, 1000);
            
            // Mettre à jour l'horloge analogique chaque seconde
            updateAnalogClock();
            setInterval(updateAnalogClock, 1000);
            
            // Initialiser l'affichage du minuteur
            updateTimerDisplay();
            
            // Créer les bulles d'arrière-plan
            createBubbles();
            
            // --- Event listeners pour l'HORLOGE ---
            
            // Format 12h/24h
            document.getElementById('format-toggle').addEventListener('click', function() {
                is24HourFormat = !is24HourFormat;
                updateClock();
            });
            
            // Basculer entre horloge numérique et analogique
            document.getElementById('digital-btn').addEventListener('click', function() {
                toggleClockMode('digital');
            });
            
            document.getElementById('analog-btn').addEventListener('click', function() {
                toggleClockMode('analog');
            });
            
            // Thèmes
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    changeTheme(theme);
                });
            });
            
            // --- Event listeners pour le CHRONOMÈTRE ---
            document.getElementById('start-btn').addEventListener('click', startStopwatch);
            document.getElementById('lap-btn').addEventListener('click', recordLap);
            document.getElementById('reset-btn').addEventListener('click', resetStopwatch);
            
            // --- Event listeners pour l'ALARME ---
            document.getElementById('set-alarm-btn').addEventListener('click', addAlarm);
            document.getElementById('clear-all-alarms-btn').addEventListener('click', clearAllAlarms);
            document.getElementById('stop-alarm-btn').addEventListener('click', stopAlarm);
            
            // Limiter les champs d'entrée de l'alarme
            document.getElementById('alarm-hours').addEventListener('input', function() {
                if (this.value > 23) this.value = 23;
                if (this.value < 0) this.value = 0;
            });
            
            document.getElementById('alarm-minutes').addEventListener('input', function() {
                if (this.value > 59) this.value = 59;
                if (this.value < 0) this.value = 0;
            });
            
            document.getElementById('alarm-seconds').addEventListener('input', function() {
                if (this.value > 59) this.value = 59;
                if (this.value < 0) this.value = 0;
            });
            
            // --- Event listeners pour le MINUTEUR ---
            document.getElementById('timer-start-btn').addEventListener('click', startTimer);
            document.getElementById('timer-pause-btn').addEventListener('click', pauseTimer);
            document.getElementById('timer-reset-btn').addEventListener('click', resetTimer);
            
            // Event listeners pour les boutons préréglés
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const minutes = parseInt(this.getAttribute('data-minutes'));
                    setTimerDuration(minutes);
                });
            });
            
            // Event listeners pour les boutons de son
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sound = this.getAttribute('data-sound');
                    playAmbientSound(sound);
                });
            });
            
            // Définir le préréglage par défaut
            try {
                document.querySelector('.preset-btn[data-minutes="25"]').classList.add('active');
            } catch (error) {
                console.error("Préréglage par défaut non trouvé:", error);
            }
        });
    </script>
</body>
</html>